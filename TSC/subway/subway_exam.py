import pandas as pd
import os as os
import numpy as np

df = pd.read_csv('tsc/data/seoul_subway_data.csv', encoding="cp949")

valid_lines = [f"{i}호선" for i in range(1, 10)]
df = df[df['호선명'].isin(valid_lines)].copy()



# 문제 1 (데이터 기본 확인) df의 행/열 개수와 컬럼 개수를 출력하시오.




# 문제 2 전체 데이터에서 값이 0인 데이터가 총 몇 개인지 구하시오.
# 힌트: .sum().sum() → 열 → 전체 합




# 문제 3 (호선 데이터 균형 확인)
# 가장 많은 행을 가진 호선과
# 가장 적은 행을 가진 호선의 행 개수 차이를 출력하시오.




# 문제 4 데이터에 등장하는 지하철역 이름의 종류 개수를 구하시오.





# 문제 5 (특정 역 데이터만 필터링)
# 지하철역이 "동대문" 인 데이터만 따로 뽑아 dongdaemun_df를 만들고, 상위 3행을 출력하시오.




# 문제 6 (특정 월 데이터만 필터링)
# 사용월이 202511 인 데이터만 뽑아 df_202511을 만들고, 행 개수를 출력하시오.




# 문제 7 모든 시간대의 승차인원만 합산한 총승차인원 컬럼을 생성하시오.




# 문제 8 모든 시간대의 하차인원만 합산한 총하차인원 컬럼을 생성하시오.




# 문제 9 총승차인원 + 총하차인원으로 총 승하차 인원 컬럼을 생성하시오.




# 문제 10 총 승하차 인원이 가장 많은 상위 5개 역을 출력하시오.




# 문제 11 출근 시간대(07시–09시)의 승차인원 합 컬럼을 생성하시오.




# 문제 12 퇴근 시간대(17시–19시)의 하차인원 합 컬럼을 생성하시오.




# 문제 13 출근 시간대 기준으로 승차인원 > 하차인원 인 역의 개수를 구하시오.




# 문제 14 출근 시간대에 승차 인원이 가장 많은 역 3개를 출력하시오.




# 문제 15 퇴근 시간대에 하차 인원이 가장 많은 역 3개를 출력하시오.




# 문제 16 오전우세 컬럼 만들기
# 오전우세는 "오전 유동 - 오후 유동" 이다.
# 유동은 (승차 + 하차) 합으로 계산한다.
#
# 오전_유동 = (07-08 유동) + (08-09 유동) + (09-10 유동) / 7시~10시만
# 오후_유동 = (17-18 유동) + (18-19 유동) + (19-20 유동) / 17시~20시만
#
# 오전우세 = 오전_유동 - 오후_유동




# 문제 17 오전우세가 큰 역 TOP 5를 출력하시오.




# 문제 18 오전/오후 성향 컬럼 만들기 
# 기준:
# 오전우세 > 0  → 오전형  (오전 유동이 오후 유동보다 큼)
# 오전우세 < 0  → 오후형  (오후 유동이 오전 유동보다 큼)
# 오전우세 == 0 → 혼합형  (오전과 오후가 동일)
#




# 문제 19 시간성향(오전형/오후형/혼합형) 별로 개수를 구해서 출력하시오.
# (힌트: 조건으로 각각 카운트, sum() 사용)




# 문제 20 출근승차 / 출근하차 기준으로 역 성격 컬럼을 생성하시오.
#
# 기준 설명:
# - 출근승차 > 출근하차  → 주거지역
#   (아침에 사람들이 '그 역에서 많이 탄다' = 집에서 나오는 사람이 많다)
#
# - 출근하차 > 출근승차  → 업무지역
#   (아침에 사람들이 '그 역에서 많이 내린다' = 회사/학교로 유입이 많다)
#
# - 출근승차 == 출근하차 → 혼합지역
#   (아침에 타고 내리는 흐름이 비슷하다)



# ================================
# 최종 보스 21~23
# ================================

# 문제 21 🔥
# 호선별로 "총승하차인원" 1등 역만 모은 데이터프레임 top_by_line을 만드시오.
# 출력 컬럼: ['호선명','지하철역','총승하차인원']
# (힌트: for문으로 호선 하나씩 필터링 → 정렬 → tail(1) → 모으기)




# 문제 22 🔥
# (피크시간대) 07-08/08-09/09-10 중에서 "유동(승차+하차)"이 가장 큰 시간대를
# '피크시간대' 컬럼으로 만들고, 그 최대 유동값을 '피크유동값' 컬럼으로 만드시오.




# 문제 23 🔥
# (4분류) 역성격을 아래 규칙으로 4개로 더 세분화하시오.
# - '강주거': 출근승차 >= 출근하차 * 1.5
# - '강업무': 출근하차 >= 출근승차 * 1.5
# - '균형형': abs(출근승차-출근하차) <= (출근승차+출근하차)*0.1
# - 그 외: '일반'




